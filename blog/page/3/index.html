
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Liu.Shatle</title>
  <meta name="author" content="liu.shatle &hearts; gmail.com">

  
  <meta name="description" content="在完成 rails 应用的功能之后，要考虑优化（重构）！ 关于 rails 的 cache 问题，网络上已经有很多说法了，我主要参考以下： http://guides.rubyonrails.org/caching_with_rails.html http://hawkins.io/2011/05 &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://shatle.github.com/blog/page/3/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="Liu.Shatle" type="application/atom+xml">
  <link href='http://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>


<body>
  <div class="container">
    <div class="left-col">
      <div class="intrude-less">
        <header id="header" class="inner">
          <hgroup>
  <div id="logo">
    
    <img class="avatar img-circle" height="220" src="https://0.gravatar.com/avatar/0fa4799fa713ef369a5ce6707e28e86f.png?s=440" width="220">
    
    <div class="clear"></div>
  </div>
  <h1><a href="/">Liu.Shatle</a></h1>
  
    <h2>沉淀生活点滴，回首忘却了的记忆</h2>
  
  <div class="clear"></div>
</hgroup>


          <ul id="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>


        </header>
      </div>
    </div>  
    <div class="mid-col">
      
        
<div id="banner" class="inner">
	<div class="container">
		<ul class="feed"></ul>
	</div>
	<small><a href="http://twitter.com/LShatle">LShatle</a> @ <a href="http://twitter.com">Twitter</a></small>
	<div class="loading">Loading...</div>
</div>
<script src="/javascripts/twitter.js"></script>
<script type="text/javascript">
	(function($){
		$('#banner').getTwitterFeed('LShatle', 4, false);
	})(jQuery);
</script>

      
      <div class="mid-col-container">
        <div id="content" class="inner">
<div>


    <article class="post">
  <header>
    
      <!-- Now we're back to normal posts. Note the links used under href in both headers.-->
        <h1 class="entry-title"><a href="/blog/2013/07/02/Rails-Cache/">Rails Cache</a></h1>
      
    
    
      <p class="meta">
        








  


<time datetime="2013-07-02T14:18:00+08:00" pubdate data-updated="true">Jul 2<span>nd</span>, 2013</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>在完成 rails 应用的功能之后，要考虑优化（重构）！</p>

<p>关于 rails 的 cache 问题，网络上已经有很多说法了，我主要参考以下：</p>

<p>http://guides.rubyonrails.org/caching_with_rails.html</p>

<p>http://hawkins.io/2011/05/advanced_caching_in_rails/</p>

<p>http://37signals.com/svn/posts/3113-how-key-based-cache-expiration-works</p>

<p>或许有版本问题，虽然我没遇到，但是学习精华在于领会方法。</p>

<p>缓存，个人觉得是根据访问频度和更新频度的数据，估计并平衡两者，才能进而提高响应速度。</p>

<h3>Fragment Cache</h3>

<p>对于碎片化的缓存，主流还是在这的，因为现今多数网站都是动态的。对于 Page Cache 大多数人并不推崇！</p>

<p>相信多数人会用 layout：</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1"># in application.haml</span>
</span><span class='line'>
</span><span class='line'><span class="o">.</span><span class="n">.</span><span class="o">.</span>
</span><span class='line'><span class="o">%</span><span class="n">body</span>
</span><span class='line'>  <span class="o">=</span> <span class="n">render</span> <span class="s1">&#39;header&#39;</span>
</span><span class='line'>  <span class="o">=</span> <span class="k">yield</span>
</span><span class='line'>  <span class="o">=</span> <span class="n">render</span> <span class="s1">&#39;bottom&#39;</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1"># in _header.haml</span>
</span><span class='line'>
</span><span class='line'><span class="o">%</span><span class="nb">p</span> <span class="n">header</span> <span class="n">content</span>
</span></code></pre></td></tr></table></div></figure>


<p>在重构加入 cache 时，可以通过两种简单的方法：</p>

<h4>方法一</h4>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1"># in application.haml</span>
</span><span class='line'>
</span><span class='line'><span class="o">.</span><span class="n">.</span><span class="o">.</span>
</span><span class='line'><span class="o">%</span><span class="n">body</span>
</span><span class='line'>  <span class="o">=</span> <span class="n">render</span> <span class="s1">&#39;header&#39;</span>
</span><span class='line'>  <span class="o">=</span> <span class="k">yield</span>
</span><span class='line'>  <span class="o">=</span> <span class="n">render</span> <span class="s1">&#39;bottom&#39;</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1"># in _header.haml</span>
</span><span class='line'><span class="o">=</span> <span class="n">cache</span><span class="p">(</span><span class="s2">&quot;header_part&quot;</span><span class="p">)</span> <span class="k">do</span>
</span><span class='line'>  <span class="o">%</span><span class="nb">p</span> <span class="n">header</span> <span class="n">content</span>
</span></code></pre></td></tr></table></div></figure>


<h4>方法二</h4>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1"># in application.haml</span>
</span><span class='line'>
</span><span class='line'><span class="o">.</span><span class="n">.</span><span class="o">.</span>
</span><span class='line'><span class="o">%</span><span class="n">body</span>
</span><span class='line'>  <span class="o">=</span> <span class="n">cache</span><span class="p">(</span><span class="s2">&quot;header&quot;</span><span class="p">)</span> <span class="k">do</span>
</span><span class='line'>    <span class="o">=</span> <span class="n">render</span> <span class="s1">&#39;header&#39;</span>
</span><span class='line'>  <span class="o">=</span> <span class="k">yield</span>
</span><span class='line'>  <span class="o">=</span> <span class="n">render</span> <span class="s1">&#39;bottom&#39;</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1"># in _header.haml</span>
</span><span class='line'>
</span><span class='line'><span class="o">%</span><span class="nb">p</span> <span class="n">header</span> <span class="n">content</span>
</span></code></pre></td></tr></table></div></figure>


<p>明显第二种方法较好，其产生的效果：</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="no">Read</span> <span class="n">fragment</span> <span class="n">views</span><span class="o">/</span><span class="n">header</span> <span class="p">(</span><span class="mi">0</span><span class="o">.</span><span class="mi">2</span><span class="n">ms</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>而第一种会有：</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="no">Read</span> <span class="n">fragment</span> <span class="n">views</span><span class="o">/</span><span class="n">header</span> <span class="p">(</span><span class="mi">0</span><span class="o">.</span><span class="mi">2</span><span class="n">ms</span><span class="p">)</span>
</span><span class='line'>  <span class="no">Rendered</span> <span class="n">share</span><span class="o">/</span><span class="n">header</span><span class="o">.</span><span class="n">haml</span> <span class="p">(</span><span class="mi">0</span><span class="o">.</span><span class="mi">5</span><span class="n">ms</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<hr />

<p>其实，最好在设置 cache 时，同时设置时时效，<a href="http://37signals.com/svn/posts/3113-how-key-based-cache-expiration-works">David: 4 This generates a lot of cache garbage</a>。虽然有些存储设备自动清理访问较少的资源（memcached 有这样的机制），但是对于明确的资源，手动设置时效可以很好地清理或者更新内容。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="o">=</span> <span class="n">cache</span><span class="p">(</span><span class="s2">&quot;bottom&quot;</span><span class="p">,</span> <span class="ss">:expires_in</span> <span class="o">=&gt;</span> <span class="mi">7</span><span class="o">.</span><span class="n">days</span><span class="p">)</span> <span class="k">do</span>
</span></code></pre></td></tr></table></div></figure>

</div>
  
  

</article>


    <article class="post">
  <header>
    
      <!-- Now we're back to normal posts. Note the links used under href in both headers.-->
        <h1 class="entry-title"><a href="/blog/2013/05/06/cancel-assets-logs/">取消 Assets 的日志显示</a></h1>
      
    
    
      <p class="meta">
        








  


<time datetime="2013-05-06T14:18:00+08:00" pubdate data-updated="true">May 6<span>th</span>, 2013</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>事情见多，或许就麻木了；事情见多了，或许就忍不住了。</p>

<p>在 <code>#rails</code> 中的开发过程中，最近常用是直接用 nginx 部署于本地 80 端口。当然， <code>rails s</code> 是也是常见的事。</p>

<p>在日志文件中，通常会看到此类 <code>#assets</code> 文件日志输出：</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="no">Started</span> <span class="no">GET</span> <span class="s2">&quot;/assets/application.js&quot;</span> <span class="k">for</span> <span class="mi">127</span><span class="o">.</span><span class="mi">0</span><span class="o">.</span><span class="mi">0</span><span class="o">.</span><span class="mi">1</span>
</span><span class='line'><span class="o">.</span><span class="n">.</span><span class="o">.</span>
</span></code></pre></td></tr></table></div></figure>


<p>这些多数时候是无关紧要的。
取消其显示的官方解释有</p>

<blockquote><p>config.assets.logger accepts a logger conforming to the interface of Log4r or the default Ruby Logger class. Defaults to the same configured at config.logger. Settingconfig.assets.logger to false will turn off served assets logging.</p></blockquote>

<p>即
在 config/environments/development.rb 中加入：</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">config</span><span class="o">.</span><span class="n">assets</span><span class="o">.</span><span class="n">logger</span> <span class="o">=</span> <span class="kp">false</span>
</span></code></pre></td></tr></table></div></figure>


<p>但是，在我这版本 3.2.8 是不行的。
于是找到了<a href="https://github.com/evrone/quiet_assets">quiet_assets</a>。
在 Gemfile 中加入 <code>gem quiet_assets</code>, 然后 <code>bundle install</code>, <code>nginx -s reload</code> 即可！</p>
</div>
  
  

</article>


    <article class="post">
  <header>
    
      <!-- Now we're back to normal posts. Note the links used under href in both headers.-->
        <h1 class="entry-title"><a href="/blog/2013/04/07/summer-palace/">走了遭圆明园</a></h1>
      
    
    
      <p class="meta">
        








  


<time datetime="2013-04-07T14:18:00+08:00" pubdate data-updated="true">Apr 7<span>th</span>, 2013</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p><img src="/images/photo/SAM_0573.JPG" alt="天朗气清" /></p>

<p>昨天，也就是北京时间的2013年4月6号，被拉去圆明园了。</p>

<p>虽然是被拉去的，但是还是相对欢乐的！</p>

<p><code>#圆明园</code> <code>#北京</code></p>

<hr />

<p>前一天刚从海滨驾校回来，左脚在亲吻了多次离合之后，已经初显羞涩。当然，这与它们初次接触分不开的。新手的同学，也就是我，还要被看似严肃实为和蔼、看似狰狞实为柔和的教练目光狠狠地鄙视，脆弱的心灵再次深受创伤。不要笑我，不就不信你没有第一次。如果真的没有，好吧，我没有笑你！</p>

<p>不知何时，自从有了所谓的小米之后，我的恋床姿势由大大变为弓。作为一个容入了休息日的学生同志来说，智能手机是万恶的万刮的。当沉睡的细胞被一部毫无作用却拥有特大笑料的小说勾引起来时，它们良好地遵守了规范的休息习惯，坚决不超过七小时。唉，让一直想在休息日和周公大战一翻的我，何日才能实现此宏伟大业啊！</p>

<p>悠扬的铃声不适时的响起，我依稀地听到某人肚子里的蛔虫却很有意见。当然，建议可以，意见是决然不行的，况且与尔何关。于是，我心安理得的决然不理会蛔虫小朋友的抗议，明智地接了个电话。其实，我挺喜欢我所设置的来电提醒铃声的，每次我都会以欣赏的角度去聆听这跳跃的浪漫的小提琴，但是，小说故事情节就此断下。</p>

<blockquote><p>话说盘古开天辟地，女娲捏泥造人，猴子也有了后代 &#8230; &#8230;</p></blockquote>

<p>美女百米来电，可及它晚风疾。最近的北京风确实挺大的，幸好我先见地除却了这缕缕青丝，以免让人误为我是柳枝，话说我还有令众女羡慕的柳腰呢。</p>

<p>生活处处精彩，事物时时新鲜。北京的天气这天看来确实是出其的好，这是当我从美女的口中听到要去圆时园时伸头往阳台得出的真知灼见。当然，我也免为其难地毫不怯意地被拉去了。</p>

<p>但问题是，我现在还在床上啊，怎么办！男生的优势被挥发得淋漓尽致，速度不重要，速率才是重点。于是，我慢慢悠悠地起床洗漱。注意我的速率是足够快的，只是初始速度有点小，所以 &#8230; &#8230;</p>

<p>当我们气势汹汹地站上公交车时，我认为我们就是千千万万中的饺子馅。然而，两美女与另外一帅哥浑然不觉的味道，让我深感佩服。咋的被煮了还这么的无所谓，突然，我才认识到，原来一切都是自己的臆想啊！</p>

<p>幸好我们坐的车与园门口有些距离，我接受了某人肚子的另一蛔虫小朋友的建议，去买了个煎饼。唉，早上没吃早餐啊。冥冥之中自好天意啊，幸好没坐 690，要不直接到了，我也就饿塌了。</p>

<hr />

<p>毫无疑问，天气这么好，蓝天加白云的，来的人怎能不多！于是，买票时多了一个脱裤子放屁的壮举。我们拿着自己含辛如苦的弄来的学生证不用，却向旁边两位纯洁天真浪漫的同学借了两个，唉，我们怎么这么可爱呢！</p>

<p>圆明园真是大啊，简直是皇家后花园、旅游之圣地、踏青之悠镜，就是腿脚会有点累，事实证明之。看着地图上弯延曲折犹如盘蛇的小道，真是令我欢喜让我忧啊。唉，我怎么这样子忧国忧民喜怒于颜间了呢！</p>

<p>不得不说，北京有水的地方基本都成为了公园了。不要问走了哪些园区，我记不住的。不要认为是我印象不深，是因为美景不胜收，怎有闲情理这破事！</p>

<p>断桥连柳，水光接天。可惜了，风景里多了熙熙攘攘的人群。试想，要是在冬天这鸟不拉屎的季节里，人会不会少多了呢。然而，如果没他人，若大这园，是不是又显得清静了呢！</p>

<p>这清代王朝好会享受，妄想通过移花接木之法把江南的风景搬来此地，这当然也是我的妄想。可是除了湖边垂柳，哪还会有南方之青郁呢。</p>

<p>到这边难免要破坏一下风景，我们和常人一般也要打扰本为仙画园景了，拍照。拍照也罢了，还经常不小心把其它游人也拉进镜头来，让法律常识超凡的我微微担心肖像权的问题，是不是回去还要截去呢！</p>

<p>当宽广的湖面映入眼睑之时，我知道，我今天是来对了，感谢旁边的美女，简直就是仙女下凡、拯救苍生啊。美女突发要拍全景，我特表惊讶，这么好的点子居然是这个下了凡的仙女想出来的，看来苍生有救了。我适时地稍微地表示我没有用过全景拍照，她居然会玩我的相机，我又表示好惊讶呢！</p>

<p>深切表示，和美女游玩，不要坐船，那，那真是欺负人啊。不要拿男士优先、女士靠边的原则来忽悠我，居然让我们两个帅锅踩踏板。在水面上，清风微凉，让我很是吃亏啊。我一脸陶醉地欣赏湖边景色，脚下却不停地踩踏板，我瞬间感觉我的功力又进入了一个层次，从人神分离到了首脚分离，当然人神分离是我从小就会的功夫了，小人不才啊。</p>

<p>打牌是个锻炼的过程，讲究是智慧与运气、先天与后天、人品与人格。对于我们两个男同胞羸了两位女同志这事，我是绝对不会外扬的，因为这会让我们遭到世人谩骂的。但是，我都说了，打牌讲究的是智慧与运气、先天与后天、人品与人格，那，其实我们也是没有办法啊。所以，停。</p>

<p>太阳由东向西，天气由晴转晴，时间在飞逝，力气也在流逝啊。打道回府也。</p>
</div>
  
  

</article>


    <article class="post">
  <header>
    
      <!-- Now we're back to normal posts. Note the links used under href in both headers.-->
        <h1 class="entry-title"><a href="/blog/2012/08/25/xiao-bai-he-shang-de-gu-shi/">小白和尚的故事</a></h1>
      
    
    
      <p class="meta">
        








  


<time datetime="2012-08-25T19:47:00+08:00" pubdate data-updated="true">Aug 25<span>th</span>, 2012</time>
        
      </p>
    
  </header>


  <div class="entry-content"><blockquote><p>故事是表达心情、心事的另一美好方式</p></blockquote>

<p>从前，山里有个庙，庙里有个小和尚。名字叫做&#8230;</p>

<p>小白。</p>

<p>他每天的工作就是永远的念经&#8230; &#8230;</p>

<p>突然有一天，老和尚派给了他一个新任务　－－</p>

<p>撞钟。</p>

<p>开始时，他不知道怎么才能让钟声响起。于是，他天天练习&#8230;</p>

<p>练习&#8230;努力&#8230;努力练习&#8230;</p>

<p>终于，春天的某天，他把那顽固的钟给撞响了。</p>

<p>学会了撞钟的小和尚，天天撞钟&#8230;！</p>

<p>老和尚有一天对他说，你这样子会累屎的&#8230;!</p>

<p>但是，他不听，他不听，终于夏天到了，他累出si了&#8230;!</p>

<p>他前去请教老和尚。老和尚说：喜欢一事物，想要长久，就要耐得住原起的欲望，不能频繁地去做。并且，他建议小和尚每周一次。</p>

<p>如老和尚所说，小和尚从此撞钟越来越得心就手　－－　他喜欢上了一周一次。</p>

<p>同时，山下的人，比起每天频繁的钟声，更是喜欢一周一次。</p>

<p>小和尚也喜欢一周一次撞钟了，如来神掌般。</p>

<p>但是，山下的人却有另一看法，？？？</p>

<p>山下的人都认为，小和尚喜欢周鸣&#8230;只是小和尚不明白而已。</p>

<p>其实，小和尚自己明白。小和尚不仅喜欢周鸣，而且习惯了周鸣，周鸣就如他生命生活中的不可或缺的一部分&#8230;</p>

<p>&lt;待续&#8230;></p>
</div>
  
  

</article>


    <article class="post">
  <header>
    
      <!-- Now we're back to normal posts. Note the links used under href in both headers.-->
        <h1 class="entry-title"><a href="/blog/2012/08/20/gemfiles-gem-reference-with-rails-app-local/">Gemfile&#8217;s Gem Reference With Rails App Local</a></h1>
      
    
    
      <p class="meta">
        








  


<time datetime="2012-08-20T15:51:00+08:00" pubdate data-updated="true">Aug 20<span>th</span>, 2012</time>
        
      </p>
    
  </header>


  <div class="entry-content"><h2>Gemfile引用Rails项目中的gem</h2>

<hr />

<h3>需求</h3>

<p>之前写了个gem，但是不好意思让其他人在他们的机器上安装吧，因为是github上的私密的项目啊。需要下载下来，安装，虽然也不难。唉，废话。</p>

<h3>解决</h3>

<p>将我本地的已经安装好的gem，放到整个rails环境中吧。</p>

<p>解压本地gem到rails项目目录。</p>

<pre><code>gem unpack my-gem --target vendor/gems
</code></pre>

<p>往Gemfile里添加</p>

<pre><code>gem 'my-gem', '0.0.1', :path =&gt; "vendor/gems/my-gem-0.0.1"
</code></pre>

<p>然后, <code>bundle install</code>确认是否成功。</p>

<p>如果，在Gemfile上的版本号不写，或者写<code>&gt;=0.0.1</code>会出现错误。小白我不懂。
解压到本地的gem没有specification文件，不能准确识别版本？可能吧。</p>
</div>
  
  

</article>


    <article class="post">
  <header>
    
      <!-- Now we're back to normal posts. Note the links used under href in both headers.-->
        <h1 class="entry-title"><a href="/blog/2012/08/20/a-tip-order-of-git-commit-file/">A Tip Order of Git Commit File</a></h1>
      
    
    
      <p class="meta">
        








  


<time datetime="2012-08-20T14:46:00+08:00" pubdate data-updated="true">Aug 20<span>th</span>, 2012</time>
        
      </p>
    
  </header>


  <div class="entry-content"><hr />

<h2>git commit的顺序小记</h2>

<hr />

<p>我在本地从master分支中新建了一个关于此模块的分支 <code>test_job</code></p>

<pre><code>git checkout -b test_job
</code></pre>

<p>此命令会自动在本地创建<code>test_job</code>分支，并从本地分支切换到<code>test_job</code>分支的。</p>

<p>然后在此分支上做了许多的工作，当想提交的时候，我想了些。此前并不意识到，可能的与其他代码人员的代码冲突，结果往往另我很伤神。</p>

<p>这次应该多检查一下才行。</p>

<p>首先，查看状态。</p>

<pre><code>git status
</code></pre>

<p>很不幸，其中有一个文件是我没想修改的。但是不知道什么时候，可能是我的原因或者编辑器的原因，对这个文件创造出了修改。这里称此文件为 <code>app/model/other_job_model.rb</code>。</p>

<p>好吧，虽然说，我是不想改这文件的。但是，刚过周末，会不会是上周的一个小需求需要修改此文件，而这周的我忘却了呢？那先具体看看此文件有哪些改动吧。</p>

<pre><code>git diff HEAD -- app/model/other_job_model.rb
</code></pre>

<p>此命令会显示文件<code>app/model/other_job_model.rb</code>最后一次提交与当前代码的区别。这里的最后一次提交应该是从<code>master</code>迁出的最后一次提交。</p>

<blockquote><pre><code>   $ git diff test            (1)
   $ git diff HEAD -- ./test  (2)
   $ git diff HEAD^ HEAD      (3)
</code></pre>

<ol>
<li>Instead of using the tip of the current branch, compare with
the tip of &#8220;test&#8221; branch.</li>
<li>Instead of comparing with the tip of &#8220;test&#8221; branch, compare
with the tip of the current branch, but limit the comparison to
the file &#8220;test&#8221;.</li>
<li>Compare the version before the last commit and the last
commit.</li>
</ol>
</blockquote>

<p>看了之后顿时无语，不知道什么时候手贱，对此文件删除了一空白行。而　git 神经紧张地报告了这一修改。好吧，至少我还是不希望这一修改提交的，虽然对他人的代码的运行不会有问题，但是，未知的东西太多了。我小白无知的太多了，别动他人代码为好。</p>

<pre><code>git checkout -- app/model/other_job_model.rb
</code></pre>

<p>相关语法：</p>

<blockquote><p>git checkout [-p|&#8211;patch] [&lt;tree-ish>] [&#8211;] [&lt;paths>&#8230;]</p></blockquote>

<p>重新查看状态</p>

<pre><code>git status
</code></pre>

<p>好了，此时的文件应该是我自己要修改的文件了。可以提交了。</p>

<pre><code>git add ./  #如果有删除或者更多非添加操作，可以　git add -A
git commit -m "test_job ok"
</code></pre>

<p>好了，此版本不会涉及到他人文件了。现在把此分支提交到远程吧。</p>

<pre><code>git push origin HEAD
</code></pre>

<p>完成，远程会自动创建<code>test_job</code>这一分支并包含刚才push的代码的。</p>
</div>
  
  

</article>


    <article class="post">
  <header>
    
      <!-- Now we're back to normal posts. Note the links used under href in both headers.-->
        <h1 class="entry-title"><a href="/blog/2012/08/17/ubuntu-one-ji-shi/">Ubuntu One记事</a></h1>
      
    
    
      <p class="meta">
        








  


<time datetime="2012-08-17T21:48:00+08:00" pubdate data-updated="true">Aug 17<span>th</span>, 2012</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>前段时间，我不小心从ubuntu one官网上删除了我自己机器上的，于是其只剩下公司电脑了。</p>

<p>回到宿舍想重新添加时，一直不知道怎么办。</p>

<p>有人说，可以从ubuntu one的客户端点击，出网页，会出现添加此设备的按钮，实际上我的没有。</p>

<p>终于方法到了：</p>

<ul>
<li>删除本地的ubuntu one 帐号。</li>
</ul>


<p>打开&#8221;密码与密钥&#8221;程序，在&#8221;密码&#8221;中找到 ubuntu one 的行，右键删除。</p>

<ul>
<li><p>打开终端运行命令。</p>

<pre><code>  u1sdtool -q

  u1sdtool -c
</code></pre></li>
</ul>


<p>重启同步进程。</p>

<ul>
<li>打开ubuntu one的客户端，输入帐号，就没问题。</li>
</ul>

</div>
  
  

</article>


    <article class="post">
  <header>
    
      <!-- Now we're back to normal posts. Note the links used under href in both headers.-->
        <h1 class="entry-title"><a href="/blog/2012/08/17/ps-yin-chu-de-%3Czhong-duan-%3Ezhi-shi-dian/">Ps引出的<终端>知识点</a></h1>
      
    
    
      <p class="meta">
        








  


<time datetime="2012-08-17T21:43:00+08:00" pubdate data-updated="true">Aug 17<span>th</span>, 2012</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>由于任务可能要涉及到，进程的管理，所以，又稍微看了ps命令，其中的很多标识都不知道它是什么意思。</p>

<p>幸运的是，在查找ps相关信息的时候，我发现了一直未意识到的基础知识：</p>

<p>&lt;终端></p>

<p>于是我把这一相关信息copy下来，以后可能会重温一下。</p>

<blockquote><p>http://forum.ubuntu.org.cn/viewtopic.php?f=50&amp;t=150603</p></blockquote>

<p>终端是一种字符型设备，它有多种类型，通常使用tty来简称各种类型的终端设备。tty是Teletype的缩写。Teletype是最早出现的一种终端 设备，很象电传打字机（或者说就是），是由Teletype公司生产的。在Linux系统的设备特殊文件目录/dev/下，终端特殊设备文件一般有以下 几种：</p>

<p>1.串行端口终端（/dev/ttySn）</p>

<p>串行端口终端（Serial Port Terminal）是使用计算机串行端口连接的终端设备。计算机把每个串行端口都看作是一个字符设备。有段时间这些串行端口设备通常被称为终端设备，因为 那时它的最大用途就是用来连接终端。这些串行端口所对应的设备名称是/dev/tts/0（或/dev/ttyS0）、/dev/tts/1（或 /dev/ttyS1）等，设备号分别是（4,0）、（4,1）等，分别对应于DOS系统下的COM1、COM2等。若要向一个端口发送数据，可以在命令 行上把标准输出重定向到这些特殊文件名上即可。例如，在命令行提示符下键入：echo test > /dev/ttyS1会把单词”test”发送到连接在ttyS1（COM2）端口的设备上。可接串口来实验。</p>

<p>2.伪终端（/dev/pty/）</p>

<p>伪终端（Pseudo Terminal）是成对的逻辑终端设备，例如/dev/ptyp3和/dev/ttyp3（或着在设备文件系统中分别是/dev/pty/m3和 /dev/pty/s3）。它们与实际物理设备并不直接相关。如果一个程序把ttyp3看作是一个串行端口设备，则它对该端口的读/写操作会反映在该逻辑 终端设备对的另一个上面（ttyp3）。而ttyp3则是另一个程序用于读写操作的逻辑设备。这样，两个程序就可以通过这种逻辑设备进行互相交流，而其中 一个使用ttyp3的程序则认为自己正在与一个串行端口进行通信。这很象是逻辑设备对之间的管道操作。对于ttyp3（s3），任何设计成使用一个串行端 口设备的程序都可以使用该逻辑设备。但对于使用ptyp3的程序，则需要专门设计来使用ptyp3 （m3）逻辑设备。</p>

<p>例如，如果某人在网上使用telnet程序连接到你的计算机上，则telnet程序就可能会开始连接到设备ptyp2（m2）上（一个伪终端 端口上）。此时一个getty程序就应该运行在对应的ttyp2（s2）端口上。当telnet从远端获取了一个字符时，该字符就会通过m2、s2传递给 getty程序，而getty程序就会通过s2、m2和telnet程序往网络上返回”login:”字符串信息。这样，登录程序与telnet程序就通 过“伪终端”进行通信。通过使用适当的软件，就可以把两个甚至多个伪终端设备连接到同一个物理串行端口上。</p>

<p>在使用设备文件系统（device filesystem）之前，为了得到大量的伪终端设备特殊文件，使用了比较复杂的文件名命名方式。因为只存在16个ttyp（ttyp0—ttypf） 的设备文件，为了得到更多的逻辑设备对，就使用了象q、r、s等字符来代替p。例如，ttys8和ptys8就是一个伪终端设备对。不过这种命名方式目前 仍然在RedHat等Linux系统中使用着。 但Linux系统上的Unix98并不使用上述方法，而使用了”pty master”方式，例如/dev/ptm3。它的对应端则会被自动地创建成/dev/pts/3。这样就可以在需要时提供一个pty伪终端。目录 /dev/pts是一个类型为devpts的文件系统，并且可以在被加载文件系统列表中看到。虽然“文件”/dev/pts/3看上去是设备文件系统中的 一项，但其实它完全是一种不同的文件系统。</p>

<p>即TELNET &#8211;TTYP3（S3：slave）&#8211;TTYP3（M3：master）&#8211;GETTY</p>

<p>实验：1、在X下打开一个orN个N终端窗口
2、#ls /dev pt*
3、关闭这个X下的终端窗口，再次运行；比较两次输出信息就明白了。
在RHEL4环境下：输出为 /dev/ptmx /dev/pts/1 存在一（master）对多（slave）的情况</p>

<p>3.控制终端（/dev/tty）</p>

<p>如果当前进程有控制终端（Controlling Terminal）的话，那么/dev/tty就是当前进程的控制终端的设备特殊文件。可以使用命令”ps –ax”来查看进程与哪个控制终端相连。对于你登录的shell，/dev/tty就是你使用的终端，设备号是（5,0）。使用命令”tty”可以查看它 具体对应哪个实际终端设备。/dev/tty有些类似于到实际所使用终端设备的一个联接。</p>

<p>4.控制台终端（/dev/ttyn, /dev/console）</p>

<p>在Linux系统中，计算机显示器通常被称为控制台终端（Console）。它仿真了类型为Linux的一种终端（TERM=Linux）， 并且有一些设备特殊文件与之相关联：tty0、tty1、tty2等。当你在控制台上登录时，使用的是tty1。使用Alt+[F1—F6]组合键时，我 们就可以切换到tty2、tty3等上面去。tty1 –tty6等称为虚拟终端，而tty0则是当前所使用虚拟终端的一个别名，系统所产生的信息会发送到该终端上。因此不管当前正在使用哪个虚拟终端，系统信 息都会发送到控制台终端上。你可以登录到不同的虚拟终端上去，因而可以让系统同时有几个不同的会话期存在。只有系统或超级用户root可以向/dev /tty0进行写操作 即下例：</p>

<pre><code>#tty（查看当前TTY）
/dev/tty1
＃echo "test tty0" &gt; /dev/tty0
test tty0
</code></pre>

<p>5.其它类型</p>

<p>Linux系统中还针对很多不同的字符设备存在有很多其它种类的终端设备特殊文件。例如针对ISDN设备的/dev/ttyIn终端设备等。这里不再赘述。</p>
</div>
  
  

</article>


    <article class="post">
  <header>
    
      <!-- Now we're back to normal posts. Note the links used under href in both headers.-->
        <h1 class="entry-title"><a href="/blog/2012/08/17/rails-lib-wen-jian/">Rails Lib 文件</a></h1>
      
    
    
      <p class="meta">
        








  


<time datetime="2012-08-17T21:42:00+08:00" pubdate data-updated="true">Aug 17<span>th</span>, 2012</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>今天在rails项目中的<code>rails_dir/lib</code>文件夹新建了个文件，当类库使用。</p>

<p>如：my_jobs.rb，内容如下:</p>

<pre><code>module Jobs
  def self.hello
    "hello"
  end
end
</code></pre>

<p>但是，当我用</p>

<pre><code>rails c
</code></pre>

<p>并不能正常加载，不是说rails项目的lib中的文件会自动加载吗？问了旁边的齐洋，哦，要模块名与文件名要同名(符合rails规则)，才能自动加载。</p>

<p>唉，之前都是习惯同名，现在不同名却能发现这一问题。多coding，才能发现问题啊。</p>
</div>
  
  

</article>


    <article class="post">
  <header>
    
      <!-- Now we're back to normal posts. Note the links used under href in both headers.-->
        <h1 class="entry-title"><a href="/blog/2012/08/17/warning-variable-is-no-longer-effective/">Warning: Variable Is No Longer Effective</a></h1>
      
    
    
      <p class="meta">
        








  


<time datetime="2012-08-17T21:40:00+08:00" pubdate data-updated="true">Aug 17<span>th</span>, 2012</time>
        
      </p>
    
  </header>


  <div class="entry-content"><pre><code>gems/soap4r-1.5.8/lib/xsd/charset.rb:13: warning: variable $KCODE is no longer effective
</code></pre>

<p>在stackoverflow上找到了解决这一问题的方法：</p>

<pre><code>http://stackoverflow.com/questions/5754965/ruby-soap4r-wsdl2ruby-rb-errors
</code></pre>

<p>即，修改文件：gems/soap4r-1.5.8/lib/xsd/xmlparser.rb的第66行，</p>

<pre><code>c.downcase == name
</code></pre>

<p>为</p>

<pre><code>c.to_s.downcase == name
</code></pre>
</div>
  
  

</article>

</div>
<nav id="pagenavi">
    
        <a href="/blog/page/2/" class="prev">Prev</a>
    
    
        <a href="/blog/page/4/" class="next">Next</a>
    
    <div class="center"><a href="/blog/archives">Blog Archives</a></div>
</nav></div>
      </div>
      <footer id="footer" class="inner"><p>
  Copyright &copy; 2013 - liu.shatle &hearts; gmail.com -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
      

<script type="text/javascript">
      var disqus_shortname = 'shatleblog';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





    </div>
  </div>
</body>
</html>
